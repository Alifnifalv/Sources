@using Eduegate.Services.Contracts.Enums
@using Eduegate.Web.Library.ViewModels

@{
    Layout = null;
    var viewIID = Eduegate.Services.Contracts.Enums.SearchView.Category;
    var windowName = "window_" + Guid.NewGuid();
}

<div id="@windowName" class="summary-wrap" ng-controller="SummaryViewCategorySettingController" ng-init="SummaryViewInit('@windowName', '@viewIID', @ViewBag.IID,'@DynamicViews.Category', @Newtonsoft.Json.JsonConvert.SerializeObject(newEduegate.Web.Library.ViewModels.ProductQuantityPriceViewModel()));">
    <div class="preload-overlay" style="display:block;">
        <div class="preloader">
            <img src="~/Images/preloader.gif" width="32" height="32" alt="Loading" />
            <div class="loadertextwrap">
                <div id="Loadertext">
                    <div id="fadetext_1" class="loadingtext">L</div>
                    <div id="fadetext_2" class="loadingtext">o</div>
                    <div id="fadetext_3" class="loadingtext">a</div>
                    <div id="fadetext_4" class="loadingtext">d</div>
                    <div id="fadetext_5" class="loadingtext">i</div>
                    <div id="fadetext_6" class="loadingtext">n</div>
                    <div id="fadetext_7" class="loadingtext">g</div>
                    <div id="fadetext_8" class="loadingtext">.</div>
                    <div id="fadetext_9" class="loadingtext">.</div>
                    <div id="fadetext_10" class="loadingtext">.</div>
                </div>
                <span class="canceloperation" ng-click="CloseSummaryPanel($event);">Cancel</span>
            </div>
        </div>
    </div>

    <div class="summary-header">
        <div class="summary-controls">
            <ul class="summary-tab">
                <li class="summary-tab-list active" title="Product Detail" content-tab="productdetail"><i class="fa fa-file-text"></i></li>
            </ul>
            <div class="alignright panelcontrols">
                <span class="remove" ng-click="CloseSummaryPanel($event);">x</span>
                <span class="minmax"></span>
            </div>
        </div>
    </div>
    <div class="quickviewwrap">
        <div id="productdetail" class="summarytab-content show">
            <h4>Category Price settings</h4>
            <div class="summary-tab-inner">

                <div class="summary-content">

                    @Html.Partial("~/Views/Shared/_InfoMessage.cshtml")
                    <div class="label-value-box">
                        <div class="label-value-box-inner">
                            <span class="label-style">Category ID</span>
                            <span class="link-content" ng-bind="ViewModels.@(DynamicViews.Category).CategoryIID"></span>
                            @*<i class="fa fa-pencil" title="Edit" ng-click="Edit('Category', ViewModels.@(DynamicViews.Category).CategoryIID)"></i>*@
                        </div>
                        <div class="label-value-box-inner">
                            <span class="label-style">Category Name</span>
                            <span class="link-content" ng-bind="ViewModels.@(DynamicViews.Category).CategoryName"></span>
                        </div>
                        <div class="label-value-box-inner">
                            <span class="label-style">Created</span>
                            <span class="link-content" ng-bind="ViewModels.@(DynamicViews.Category).Created"></span>
                        </div>
                        <div class="label-value-box-inner">
                            <span class="label-style">Updated</span>
                            <span class="link-content" ng-bind="ViewModels.@(DynamicViews.Category).Updated"></span>
                        </div>
                    </div>
                </div>

                <div class="summary-toggle">
                    <div class="sum_toggleheader" ng-click="GetDynamicViewGrid('@DynamicViews.CategorySKUMaps', ViewModels.@(DynamicViews.Category).CategoryIID, false, $event)">Associated Products</div>
                    <div class="sum_togglecontent">
                        <table class="data-grid">
                            <thead>
                                <tr>
                                    <th>SKU ID</th>
                                    <th>Product Name</th>
                                    <th>Bar Code</th>
                                    <th>Part Number</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="grid in ViewModels.@(DynamicViews.CategorySKUMaps)">
                                    <td> <span ng-bind="grid.ProductSKUMapIID"></span> </td>
                                    <td><span ng-bind="grid.ProductName"></span> </td>
                                    <td><span ng-bind="grid.BarCode"></span></td>
                                    <td> <span ng-bind="grid.PartNo"></span> </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="summary-toggle">
                    <div class="sum_toggleheader" data-slide="sp-settings" ng-click="GetCategoryPriceSettings('@DynamicViews.CategoryPriceSetting', ViewModels.@(DynamicViews.Category).CategoryIID)">Selling price setting</div>
                    <div class="sum_togglecontent" data-slide="sp-settings">
                        <span id="spanPriceList" class="inputwrap">
                            <ui-select id="PriceList" theme="select2" class="pos-txt" style="width:400px; height:26px;" ng-model="ProductPrice" ng-change="SelectCategoryPriceList('@DynamicViews.CategoryPriceSetting', ViewModels.@(DynamicViews.Category).CategoryIID, @Newtonsoft.Json.JsonConvert.SerializeObject(new ProductPriceCategoryViewModel()), $select);">
                                <ui-select-match placeholder="Search PriceList">{{$select.selected.Value}}</ui-select-match>
                                <ui-select-choices repeat="productPrice in ProductPriceLists | filter:$select.search">{{productPrice.Value}}</ui-select-choices>
                            </ui-select>
                        </span>
                        <div class="fullwidth alignleft textright paddingbtm5 paddingtop5">
                            <input type="button" value="Save" class="button-orange" ng-click="SaveCategoryPriceSetting('@DynamicViews.CategoryPriceSetting',ViewModels.@(DynamicViews.Category).CategoryIID);" />
                            <input type="button" value="Cancel" class="button-orange" ng-click="GetCategoryPriceSettings('@DynamicViews.CategoryPriceSetting', ViewModels.@(DynamicViews.Category).CategoryIID);" />
                        </div>
                        <table class="data-grid" cellpadding="0" cellspacing="0">
                            <thead>
                                <tr>
                                    <th class="medium-col-width">PriceList Name</th>
                                    <th class="small-col-width">Price</th>
                                    <th class="small-col-width">Discount</th>
                                    <th class="small-col-width">Discount Percentage</th>
                                    <th class="medium-col-width last"></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="categoryPriceSetting in ViewModels.@(DynamicViews.CategoryPriceSetting)">
                                    <td class="medium-col-width"><span ng-bind="categoryPriceSetting.PriceDescription"></span></td>
                                    <td class="small-col-width"><input type="text" class="ng-pristine" ng-model="categoryPriceSetting.Price"></td>
                                    <td class="small-col-width"><input type="text" class="ng-pristine" ng-model="categoryPriceSetting.DiscountPrice"></td>
                                    <td class="small-col-width"><input type="text" class="ng-pristine" ng-model="categoryPriceSetting.DiscountPercentage"></td>
                                    <td class="small-col-width textcenter">
                                        <span class="button-orange qtybtn" ng-click="RemoveGridRow($event, $index, @Newtonsoft.Json.JsonConvert.SerializeObject(new ProductPriceCategoryViewModel()), ViewModels.@(DynamicViews.CategoryPriceSetting))">
                                            <i class="fa fa-minus"></i>
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                @*<div class="summary-toggle">
                        <div class="sum_toggleheader" data-slide="pricesettings-cg" ng-click="GetPriceSettingCustomerGroups('@DynamicViews.CustomerGroup')">Price setting for Customer Group</div>
                        <div class="sum_togglecontent" data-slide="pricesettings-cg">
                            <div class="fullwidth alignleft textright paddingbtm5">
                                <input type="button" value="Save" class="button-orange" ng-click="SavePriceSettingCustomerGroups('@DynamicViews.CustomerGroup');" />
                                <input type="button" value="Cancel" class="button-orange" ng-click="ResetPriceSettingCustomerGroups('@DynamicViews.CustomerGroup');" />
                            </div>

                            <div class="fullwidth alignleft">
                                <div class="summary-toggle">
                                    <div class="sum_toggleheader" data-slide="multipricing">Customer Groups(for multi pricing)</div>
                                    <div class="sum_togglecontent" data-slide="multipricing">
                                        <div class="fullwidth">
                                            <div class="innertoggle ng-scope" ng-repeat="customerGroup in ViewModels.@(DynamicViews.CustomerGroup)">
                                                <div class="sum_innerheader ng-binding" ng-click="ToggleInnerGroup($event)" ng-bind-html="customerGroup.GroupName">Blue Member</div>
                                                <div class="sum_innercontent fullwidth">
                                                    <table class="data-grid" cellpadding="0" cellspacing="0">
                                                        <thead>
                                                            <tr>
                                                                <th class="medium-col-width">PriceList Name</th>
                                                                <th class="small-col-width">Price</th>
                                                                <th class="small-col-width">Discount</th>
                                                                <th class="small-col-width">Discount Percentage</th>
                                                                <th class="small-col-width last"></th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td class="medium-col-width" ng-bind-html="customerGroup.PriceListName"></td>
                                                                <td class="small-col-width"><input type="text" class="ng-pristine" ng-model="customerGroup.Price"></td>
                                                                <td class="small-col-width"><input type="text" class="ng-pristine" ng-model="customerGroup.Discount"></td>
                                                                <td class="small-col-width"><input type="text" class="ng-pristine" ng-model="customerGroup.DiscountPercentage"></td>

                                                            </tr>
                                                            <tr class="quantity-toggle">
                                                                <td colspan="5" class="nopadding">
                                                                    <div class="quantity-fieldswrap fullwidth alignleft">
                                                                        <table class="quantityfields fullwidth">
                                                                            <thead>
                                                                                <tr>
                                                                                    <th class="medium-col-width">Quantity</th>
                                                                                    <th class="medium-col-width">Discount</th>
                                                                                    <th class="medium-col-width">Discount percentage</th>
                                                                                    <th class="small-col-width"></th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                                <tr class="ng-scope" ng-repeat="quantityPrice in customerGroup.QuantityPrice">
                                                                                    <td class="medium-col-width"><input type="text" ng-model="quantityPrice.Quantity"></td>
                                                                                    <td class="medium-col-width"><input type="text" ng-model="quantityPrice.Discount"></td>
                                                                                    <td class="medium-col-width"><input type="text" ng-model="quantityPrice.DiscountPercentage"></td>
                                                                                    <td class="textcenter small-col-width">
                                                                                        <span class="button-orange qtybtn" ng-click="InsertGridRow($event, $index, ModelQuantityStructure, customerGroup.QuantityPrice)"><i class="fa fa-plus"></i></span>
                                                                                        <span class="button-orange qtybtn" ng-click="RemoveGridRow($event, $index, ModelQuantityStructure, customerGroup.QuantityPrice)"><i class="fa fa-minus"></i></span>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>*@
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {

        $('#@windowName .summary-panel .remove').on('click', function () {
            $('.pagecontent', '#@windowName').removeClass('summaryview');
        });

        $('#@windowName .summary-toggle .sum_toggleheader').on('click', function () {
            $(this).parent().toggleClass('show');

            if ($(this).parent().hasClass('show')) {
                $(this).parent().addClass('show');
                $(this).parent().find('.sum_togglecontent').slideDown('fast');
            }
            else {
                $(this).parent().removeClass('show');
                $(this).parent().find('.sum_togglecontent').slideUp('fast');
            }
        });
        $('#@windowName .summary-toggle .sum_toggleheader').on('click', function () {
            var dataslide = $(this).attr('data-slide');
            $(this).toggleClass('show');
            if ($(this).hasClass('show')) {
                $(".sum_togglecontent[data-slide='" + dataslide + "']").slideDown('fast');
            }
            else {
                $(".sum_togglecontent[data-slide='" + dataslide + "']").slideUp('fast');
            }
        });


        $('#@windowName .summarytab-content.first').show();

        $('#@windowName .summary-tab .summary-tab-list').on('click', function () {
            $('.summary-tab-list', '#@windowName').removeClass('active');
            $('.summarytab-content', '#@windowName').hide();
            $(this).addClass('active');
            $('#' + $(this).attr('content-tab'), '#@windowName').fadeIn('medium');
        });

        $('#@windowName').parents('.pagecontent').addClass("minimize-fields priceview"); //Added one class to increase width for the smart view

    });
</script>


