@model Eduegate.Web.Library.ViewModels.Frameworks.SmartTreeViewViewModel

@{ 
    if (Context.Request.Headers["X-Requested-With"] == "XMLHttpRequest")
    {
        Layout = null;
    }

    Random rnd = new Random();
    var windowName = "window_" + rnd.Next().ToString();
}

<div id="@(Model.SmartViewType.ToString())SmartView"
     class="smartView DashbaordWindow windowcontainer"
     ng-controller="SmartTreeViewController"
     ng-init="init(@Newtonsoft.Json.JsonConvert.SerializeObject(Model),'@windowName', '@(Model.SmartViewType.ToString())SmartView', '@(Model.SmartViewType.ToString())')">

    <script type="text/ng-template" id="nestedTreeView">
        <a href="#" id="menuLink_{{node.NodeID}} " class="parent_li_view">
            <span class="displayFlex alignCenter">
                <span class="tree_icon"></span>
                <span class="displayFlex alignCenter flexAuto label" ng-click="FireEvent($event, node)">
                    <i class='fa fa-plus-square-o'></i>
                    <img src="{{node.ImageUrl}}" />
                    @*<img src="images/category.png"/>*@
                    <label class="trimHolder">{{node.NodeName}}</label>
                </span>
                <span class="tree_controls">
                    <i class="fa fa-pencil editiconright" ng-click="HandleEditCategory($event, node)"></i>
                    <i class="fa fa-plus addiconright"></i>
                </span>
            </span>
        </a>
        <ul ng-if="node.Nodes && node.Nodes.length > 0" style="display:none">
            <li ng-repeat="node in node.Nodes" ng-include="'nestedTreeView'" ng-class=""
                @*{'parent_li': node.Nodes.length > 0, 'nosubitem': node.Nodes.length == 0}*@>
                <a href="#" id="menuLink_{{node.NodeID}} " class="parent_li_view">
                    <span>
                        <label>{{node.NodeName}}</label>
                    </span>
                    <span>
                        <i class='fa fa-plus-square-o' ng-click="FireEvent($event, node)"></i>
                        @*<img src="{{node.ImageUrl}}">*@
                        <label style="padding: 4px 0 0 5px;" class="trimHolder" ng-click="FireEvent($event, node)">{{node.NodeName}}</label>
                        <span style="float:right;padding-right: 6px;">
                            <i class="fa fa-pencil editiconright"></i>
                            <i class="fa fa-plus addiconright"></i>
                        </span>
                    </span>
                </a>
            </li>
        </ul>
    </script>

    <div class="main-page relativePosition fullheight" id="sortable">
        <div class="leftnav-tree-blk">
            <div class="searchmenu relativePosition">
                <input type="text" class="" placeholder="Filter" ng-model="SearchText"
                       ng-keydown="$event.keyCode === 13 && LoadTreeView()" ng-change="LoadTreeView()">
                <span ng-click="LoadTreeView()"><i class="fa fa-search"></i></span>
            </div>
            <div class="leftnav-tree-filter">
                <ul class="category-list">
                    <li ng-repeat="node in Nodes" ng-include="'nestedTreeView'"></li>
                </ul>
            </div>
        </div>

        <div class='bounce-wrapper' id='shoLoad'>
            <div class='three-bounce-inner'>
                <div class='bounce-item bi-item1'></div>
                <div class='bounce-item bi-item2'></div><div class='bounce-item bi-item3'>
                </div>
            </div>
        </div>
    </div>
</div>


    <script>
        $(document).ready(function () {
            $("#vtophover").click(function () {
                $("#hovericonshow").toggle();
            });

            $(".leftnav-tree-close button").click(function () {
                $("#ProductSmartView").remove();
                $(".leftnav-tree").removeClass("slide");
            });

            $('.leftnav-tree ul.category-list li').each(function (e) {
                $(this).addClass('parent_li');
            });

            //$('.leftnav-tree ul.category-list li ul > li').each(function (e) {
            //    var child = $(this).find("ul");
            //    if (child.length > 0) {
            //        $(this).removeClass('parent_li').addClass('submenu');
            //    }
            //});

            $('.leftnav-tree').on('click', 'li.parent_li > a', function (e) {
                e.preventDefault();
            });

            $('.leftnav-tree').on('click', 'li.nosubitem > a', function () {
                $('li.parent_li > a').removeClass('active');
                $('li.submenu > a').removeClass('active');
                $('li.nosubitem > a').removeClass('active');
                $(this).parents('li.parent_li').find('> a').addClass('active');
                $(this).parents('li.submenu').find('> a').addClass('active');
                $(this).addClass('active');
            });

            $(".leftnav-tree li.parent_li i.plustominus").click(function () {
                $(this).toggleClass("fa-minus-square-o");
                $(this).toggleClass("fa-plus-square-o");
                $(this).parent().parent().siblings(".submenuparent").toggle();
            });
            $("li.submenu a i.plustominus").click(function () {
                $(this).parent().siblings().toggle();
            });
        });

    </script>

</div>

