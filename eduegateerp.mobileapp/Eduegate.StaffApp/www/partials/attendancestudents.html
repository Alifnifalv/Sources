<div class="app-page flex-column flex-column-fluid">

    <div class="app-content flex-column-fluid theme-dark-bg-body">

        <ng-include src="'partials/Templates/header.html'" class="app-header d-flex"></ng-include>

        <div class="app-toolbar py-3 py-lg-0">
            <div class="app-container container-xxl d-flex flex-stack">
                <div class="page-title d-flex flex-column justify-content-center me-3">
                    <h1 class="page-heading d-flex text-dark fw-bold fs-2 flex-column justify-content-center my-0">
                        Today's Attendance
                    </h1>
                </div>
            </div>
        </div>
        <div class="d-flex align-items-center gap-2 gap-lg-3">
            <div class="container-fluid">
                <div class="row g-4">
                    <!-- Loop through each student returned from the API -->
                    <div class="col-12 col-md-6 col-lg-4" ng-repeat="student in Students ">

                        <div class="card h-100 shadow-sm"  ng-click="StudentsAttendanceDetailsViewClick(student.StudentIID, student.StudentFullName)">
                            <div class="card-body p-3">

                                <!-- Top Section: Student Info & Status Badge -->
                                <div class="d-flex align-items-center mb-3">
                                    <!-- Avatar -->
                                    <div class="symbol symbol-50px symbol-circle me-3">
                                        <img ng-src="{{ContentService}}/ReadImageContentsByID?contentID={{student.StudentProfile}}"
                                            on-error-src="./clients/{{$root.ClientSettings.Client}}/images/profile_img.png"
                                            alt="{{student.StudentFullName}}"
                                            style="    object-fit: cover;     object-position: right top;">
                                    </div>

                                    <!-- Name and Admission Number -->
                                    <div class="flex-grow-1">
                                        <div class="fw-bold text-dark fs-6">{{student.StudentFullName}}</div>
                                        <div class="text-muted fs-7">Adm No: {{student.AdmissionNumber}}</div>
                                    </div>

                                    <!-- Attendance Status Badge -->
                                    <span class="badge fs-7 ms-2"  style="color: #ccc;" title="{{student.AttendanceStatus}}" ng-class="{
                                'bg-light-success text-success': student.AttendanceStatus === 'Present',
                                'bg-light-danger text-danger': student.AttendanceStatus === 'Absent',
                                'bg-light-warning text-warning': student.AttendanceStatus === 'Late',
                                'bg-light-info text-info': student.AttendanceStatus === 'Leave',
                                'bg-light-secondary text-gray-800': student.AttendanceStatus === 'Not Marked'
                              }">
                                        {{student.AttendanceStatus}}
                                    </span>
                                </div>
                               

                                <!-- Bottom Section: Action Buttons -->
                                <div class="text-end">
                                         <a ng-click="StudentsAttendanceDetailsViewClick(student.StudentIID, student.StudentFullName)">
                                        <i class="fa fa-eye"></i> View Attendance Details
                                         </a>
                                    <div class="btn-group" role="group">
                                        <button type="button" class="btn btn-sm"
                                            ng-repeat="status in AttendanceStatuses track by status.PresentStatusID"
                                            ng-click="MarkAttendance(student, status.PresentStatusID)" ng-class="{
                                        'btn-success': status.StatusDescription === 'Present' && student.PresentStatusID === status.PresentStatusID,
                                        'btn-outline-success': status.StatusDescription === 'Present' && student.PresentStatusID !== status.PresentStatusID,
                                        
                                        'btn-danger': status.StatusDescription === 'Absent' && student.PresentStatusID === status.PresentStatusID,
                                        'btn-outline-danger': status.StatusDescription === 'Absent' && student.PresentStatusID !== status.PresentStatusID,
                                        
                                        'btn-warning': status.StatusDescription === 'Late' && student.PresentStatusID === status.PresentStatusID,
                                        'btn-outline-warning': status.StatusDescription === 'Late' && student.PresentStatusID !== status.PresentStatusID
                                    }">
                                            {{status.StatusDescription}}
                                        </button>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="app-container container-xxl pt-5">
</div>

</div>
</div>