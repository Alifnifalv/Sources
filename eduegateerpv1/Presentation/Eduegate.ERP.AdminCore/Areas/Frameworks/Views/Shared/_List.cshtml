@model Eduegate.Web.Library.ViewModels.SearchListViewModel
@{
    var windowName = "window_" + Guid.NewGuid().ToString();
    ViewBag.WindowName = windowName;
    string model = Model.IsChild ? "ChildModel" : "RowModel";
}

<div class="pagecontent p-0" style="display:flex;height:90%"" id="@windowName" ng-controller="TableRowsController as RowModel"
     ng-init="RowModel.activate('#@windowName', '@(!string.IsNullOrEmpty(Model.ControllerName) ? Model.ControllerName : Model.ViewName.ToString())', '@Model.JsonModel', '@Model.ViewName.ToString()', @Model.HasFilters.ToString().ToLower(), @Model.EnabledSortableGrid.ToString().ToLower(), '@Model.RuntimeFilter')">
    <div class="prod-tab-wrap" style="height: 100%;">
        <div class="producttab">
            <div class="producttab-space">
                @await Html.PartialAsync("~/Areas/Frameworks/Views/Shared/_ListFilter.cshtml", Model)

                <div class="wrapper">
                    <div class="tablewrapper">
                        @if (Model.EnabledSortableGrid)
                        {
                            await Html.RenderPartialAsync("~/Areas/Frameworks/Views/Shared/_SortableTable.cshtml", Model);
                        }
                        else
                        {

                                            <table cellpadding="0" cellspacing="0"  stye="width:100%">
                                                   <tbody>
                                                        @{
                                                            await Html.RenderPartialAsync("~/Views/Shared/_TableHeader.cshtml", Model);
                                                        }
                                                    </tbody>
                                                    <tbody>
                                                        @{

                                                            await Html.RenderPartialAsync("~/Views/Shared/_TableRows.cshtml", Model);
                                                        }
                                                    </tbody>


                                            </table>

                            <div ng-if="!@(model).rows.length || @(model).rows.length == 0">
                                <div colspan="@(Model.HeaderList.Where(x=> x.IsVisible).Count() + 2)" style="background-color:white">
                                    <center>
                                        <i class="content-load fa fa-circle-o-notch fa-pulse waypoint"
                                           style="font-size:20px;"></i>
                                    </center>
                                    <div ng-if="@(model).rows.length == 0">
                                        <center>
                                            <span>@Eduegate.ERP.Admin.Globalization.ResourceHelper.GetValue("No records found")!!</span>
                                        </center>
                                    </div>
                                </div>
                            </div>
                            
                            
                        }

                        <div class="popup gridpopupfields" data-popup-type="gridpopupfields">
                            <div class="popup-wrap" id="popupContainer">
                            </div>
                        </div>

                        <div class="dataDisplayPopup">
                            <div class="dataDisplayInner borderRadius4">
                            </div>
                            <span class="dataPointer"></span>
                        </div><!--descriptionPopUp-->

                        <script id="dataHistoryTemplate" type="text/ng-template">
                            <table class="table table-striped table-responsive-md btn-table">
                                <tr>
                                    <td>Created by</td>
                                    <td>{{HistoryInfo.CreatedUserName}}</td>
                                </tr>
                                <tr>
                                    <td>Created on</td>
                                    <td>{{HistoryInfo.CreatedDate | date:_dateTimeFormat}}</td>
                                </tr>
                                <tr>
                                    <td>Updated by</td>
                                    <td>{{HistoryInfo.UpdatedUserName}}</td>
                                </tr>
                                <tr>
                                    <td>Updated on</td>
                                    <td>{{HistoryInfo.UpdatedDate | date:_dateTimeFormat}}</td>
                                </tr>
                            </table>
                        </script>
                    </div>
                </div>
            </div>
            @await Html.PartialAsync("~/Areas/Frameworks/Views/Shared/_FilterView.cshtml")            
        </div>
        <div id="summarypanel" class="summary-panel">

        </div><!--summary-->
    </div>
    <div class="page-nav position-fixed bottom-0 m-0 bg-light">
        <ul class="m-0">
            <li>Total &nbsp;<span ng-bind="RowModel.TotalRecords" /> records</li>
            <li ng-click="RowModel.FirstPage($event)" title="Go to first page"><i class="fa fa-fast-backward"></i></li>
            <li ng-click="RowModel.PreviousPage($event)" title="previous"><i class="fa fa-step-backward"></i></li>
            <li>Page <span ng-bind="RowModel.CurrentPage"></span> of <span ng-bind="RowModel.TotalPages"></span></li>
            <li ng-click="RowModel.NextPage($event)" title="next"><i class="fa fa-step-forward"></i></li>
            <li ng-click="RowModel.LastPage($event)" title="Go to last page"> <i class="fa fa-fast-forward"></i></li>
            <li class="last"><span>Go to page: &nbsp;<input type="text" id="txtGetPageNo" ng-model="RowModel.GoToPageNo" ng-keyup="$event.keyCode == 13 && RowModel.GoToPage($event)" /></span></li>
        </ul>
    </div>

    <script>
        $(document).ready(function () {
            var firstInput = $('.skien-filter-panel').find('input[type!=hidden]:first');
            if (firstInput) {
                firstInput.focus();
            }            
        });
    </script>
</div>
