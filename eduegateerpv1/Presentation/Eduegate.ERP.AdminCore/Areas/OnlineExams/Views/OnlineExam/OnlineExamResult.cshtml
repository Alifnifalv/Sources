@{ 
    if (Context.Request.Headers["X-Requested-With"] == "XMLHttpRequest")
    {
        Layout = null;
    }

    Random rnd = new Random();
    var windowName = "window_" + rnd.Next().ToString();
}

<div id="OnlineExamResult" class="windowcontainer" ng-controller="OnlineExamResultController" ng-init="Init(@Newtonsoft.Json.JsonConvert.SerializeObject(Model),'@windowName', 'onlineExamResult')">

    <div class="main-page row g-0 g-xl-2 mb-5 mb-xl-10">
        <div class="col-md-12">
            <div class="app-toolbar">
                <div class="app-container  container-fluid d-flex align-items-stretch ">
                    <div class="app-toolbar-wrapper d-flex flex-stack flex-wrap gap-4 w-100">
                        <div class="page-title d-flex flex-column justify-content-center gap-1 me-3">
                            <h1 class="page-heading d-flex flex-column justify-content-center text-dark fw-bold fs-3 m-0">
                                Online exam result
                            </h1>
                            <ul class="breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0">
                                <li class="breadcrumb-item text-muted">
                                    <a class="text-muted text-hover-primary">
                                        Online exam
                                    </a>
                                </li>
                                <li class="breadcrumb-item">
                                    <span class="bullet bg-gray-400 w-5px h-2px"></span>
                                </li>
                                <li class="breadcrumb-item text-muted">
                                    Result
                                </li>

                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="window-tab preload-overlay" style="display:none;">
            <div class="preloader"><img src="/Images/preloader.GIF" width="32" height="32" alt="Loading" /></div>
        </div>

        <div class="main-page row g-0 g-xl-2 mb-5 mb-xl-10">
            <div class="scheduleWrapper innertab subject" id="ExamResultTab" style="display:block">
                <div class="col-md-12">
                    <div class="app-content  flex-column-fluid p-0">
                        <div class="app-container  container-fluid ">
                            <div class="row gy-0 g-xl-2">
                                <div class="col-lg-4">
                                    <span class="form-group">
                                        <span class="controls w-75">
                                            <label>Academic year<span class="cufon" style="color:red;font-weight:700">&nbsp;*</span></label>
                                            <span class="controls brand">
                                                <select class="form-control validate" required="" aria-required="true" name="AcademicYear" id="AcademicYear"
                                                        ng-options="item as item.Value for item in AcademicYears track by item.Key"
                                                        ng-model="SelectedAcademicYear" autofocus=autofocus tabindex="0">
                                                </select>
                                                <i class="dropdownarrow fa fa-caret-down"></i>
                                            </span>
                                        </span>
                                    </span>
                                </div>
                                <div class="w-100"></div>
                                <div class="col-lg-4">
                                    <span class="form-group">
                                        @* <span class="controls w-75">
                                            <label>Candidate<span class="cufon" style="color:red;font-weight:700">&nbsp;*</span></label>
                                            <ui-select name="Candidate" ng-model="SelectedCandidate" theme="select2" class="pos-txt" ng-change="SearchCriteriaChanges($select.selected, 'candidate')">
                                                <ui-select-match placeholder="Search">{{$select.selected.Value}}</ui-select-match>
                                                <ui-select-choices repeat="candiate in Candidates | filter:$select.search">
                                                    {{candiate.Value}}
                                                </ui-select-choices>
                                            </ui-select>
                                        </span> *@
                                        <span class="controls w-75">
                                            <label>Candidate<span class="cufon" style="color:red;font-weight:700">&nbsp;*</span></label>
                                            <span class="controls brand">
                                                <ui-select style="width: 100%;" ng-model="SelectedCandidate"
                                                           theme="select2" class="pos-txt" sortable="true" name="Candidate" id="Candidate" ng-change="SearchCriteriaChanges($select.selected, 'candidate')">
                                                    <ui-select-match placeholder="Search">{{$select.selected.Value}}</ui-select-match>
                                                    <ui-select-choices repeat="candidate in Candidates | filter:$select.search">{{candidate.Value}}</ui-select-choices>
                                                </ui-select>
                                            </span>
                                        </span>
                                    </span>
                                </div>
                                <div class="w-100"></div>
                                <div class="col-lg-4">
                                    <span class="form-group">
                                        <span class="controls w-75">
                                            <label>Exam<span class="cufon" style="color:red;font-weight:700">&nbsp;*</span></label>
                                            <ui-select name="Exam" ng-model="SelectedExam" theme="select2" class="pos-txt" ng-change="SearchCriteriaChanges($select.selected, 'exam')">
                                                <ui-select-match placeholder="Search">{{$select.selected.Value}}</ui-select-match>
                                                <ui-select-choices repeat="exam in OnlineExams | filter:$select.search">
                                                    {{exam.Value}}
                                                </ui-select-choices>
                                            </ui-select>
                                        </span>
                                    </span>
                                </div>
                                <div class="w-100"></div>
                                <div class="col-lg-2">
                                    <div>
                                        <button type="button" class="btn btn-sm  btn-primary  me-1" ng-click="GetExamResult()">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-bar-down  fs-3 me-1" viewBox="0 0 16 16">
                                                <path fill-rule="evenodd" d="M1 3.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5zM8 6a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 0 1 .708-.708L7.5 12.293V6.5A.5.5 0 0 1 8 6z" />
                                            </svg>
                                            Get result
                                        </button>
                                    </div>
                                </div>
                                <div class="col-lg-2">
                                    <button type="button" class="btn btn-sm  btn-success" ng-click="ResetMarkEntry()">
                                        <span class="indicator-label">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-repeat  fs-3 ms-1 me-0" viewBox="0 0 16 16">
                                                <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"></path>
                                                <path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"></path>
                                            </svg>
                                            Reset
                                        </span>

                                    </button>
                                </div>
                                <div class="w-100"></div>
                                <div class="w-100"></div>
                                <div class="col-lg-4">
                                    <button type="button" class="btn btn-sm  btn-success" ng-disabled="!ExamResult" ng-click="SaveMarkEntry()">
                                        <span class="indicator-label">
                                            Save Entry

                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download fs-3 ms-2 me-0" viewBox="0 0 16 16">
                                                <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z" />
                                                <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z" />
                                            </svg>
                                        </span>

                                    </button>
                                </div>

                                <div class="app-content  flex-column-fluid">

                                    <div class="card card-flush mb-5 mb-xl-10">
                                        <div class="card-body p-0">
                                            <div class="dataTables_wrapper dt-bootstrap4 no-footer">
                                                <div class="table-responsive">
                                                    <table class="table align-middle fs-6 gy-3  no-footer mb-0">
                                                        <thead style=" background: #f5f5f5; border-bottom: 1px solid #e1e1e1; border-top: 1px solid #e1e1e1;">
                                                            <tr class="text-start align-middle text-gray-600 fw-normal fs-7  gs-0 text-truncate">
                                                                <th class="text-start align-middle pe-3 min-w-150px sorting">Exam</th>
                                                                <th class="text-end align-middle  min-w-30px sorting">Total questions</th>
                                                                <th class="text-end align-middle  min-w-30px sorting">Total mark</th>
                                                                <th class="text-end align-middle pe-3 min-w-30px sorting">Marks obtained</th>
                                                                <th class="text-end align-middle  min-w-30px sorting">Result percentage</th>
                                                                <th class="text-end align-middle pe-3 min-w-0px sorting">Result status</th>
                                                                <th class="text-end align-middle  min-w-30px sorting">Remarks</th>
                                                                <th class="text-end align-middle  min-w-30px sorting"></th>
                                                                <th class="text-end align-middle  min-w-30px sorting"></th>
                                                            </tr>
                                                        </thead>
                                                        <tbody class="fw-normal text-gray-800 text-truncate">
                                                            <tr ng-if="ExamResult" ng-init="current1 = $parent.start; $parent.start=$parent.start+1;">
                                                                <td class="text-start align-middle">
                                                                    {{ExamResult.OnlineExam.Value}}
                                                                </td>
                                                                <td class="text-end align-middle">
                                                                    {{ExamResult.QuestionMapResults.length}}
                                                                </td>
                                                                <td class="text-end align-middle">
                                                                    {{ExamResult.TotalMarks}}
                                                                </td>
                                                                <td class="text-end align-middle">
                                                                    {{ExamResult.MarksObtained}}
                                                                </td>
                                                                <td class="text-end align-middle">
                                                                    {{ExamResult.ObtainedMarksPercentage}}
                                                                </td>
                                                                <td class="text-end align-middle">
                                                                    <span class="controls brand min-w-75px">
                                                                        <select class="form-control" name="ResultStatus" id="ResultStatus"
                                                                                ng-options="item as item.Value for item in ResultStatuses track by item.Key"
                                                                                ng-model="ExamResult.ResultStatus">
                                                                            <option value=""></option>
                                                                        </select>
                                                                        <i class="dropdownarrow fa fa-caret-down"></i>
                                                                    </span>
                                                                </td>
                                                                <td class="text-end align-middle">
                                                                    <span><input type="text" ng-model="ExamResult.Remarks" /></span>
                                                                </td>
                                                                <td class="text-end">
                                                                    <div class="controls text-center">
                                                                        <button type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample{{current1}}" aria-expanded="false" aria-controls="collapseExample1{{current1}}"
                                                                                class="btn btn-sm btn-icon btn-light btn-active-light-primary toggle h-25px w-25px">
                                                                            <span class="svg-icon svg-icon-3 m-0" ng-if="ExamResult.IsExpand">
                                                                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                                    <rect x="6" y="11" width="12" height="2" rx="1" fill="currentColor"></rect>
                                                                                </svg>
                                                                            </span>
                                                                            <span class="svg-icon svg-icon-3 m-0" ng-if="!ExamResult.IsExpand">
                                                                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                                    <rect opacity="0.5" x="11" y="18" width="12" height="2" rx="1" transform="rotate(-90 11 18)" fill="currentColor"></rect>
                                                                                    <rect x="6" y="11" width="12" height="2" rx="1" fill="currentColor"></rect>
                                                                                </svg>

                                                                            </span>
                                                                            <!--end::Svg Icon-->
                                                                        </button>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr ng-if="!ExamResult" >
                                                                <td class="ex-large-col-width" colspan="100%">
                                                                    <div class="text-center">
                                                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-database-fill-exclamation w-30px h-30px" viewBox="0 0 16 16">
                                                                            <path d="M8 1c-1.573 0-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4s.875 1.755 1.904 2.223C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777C13.125 5.755 14 5.007 14 4s-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1Z" />
                                                                            <path d="M2 7v-.839c.457.432 1.004.751 1.49.972C4.722 7.693 6.318 8 8 8s3.278-.307 4.51-.867c.486-.22 1.033-.54 1.49-.972V7c0 .424-.155.802-.411 1.133a4.51 4.51 0 0 0-4.815 1.843A12.31 12.31 0 0 1 8 10c-1.573 0-3.022-.289-4.096-.777C2.875 8.755 2 8.007 2 7Zm6.257 3.998L8 11c-1.682 0-3.278-.307-4.51-.867-.486-.22-1.033-.54-1.49-.972V10c0 1.007.875 1.755 1.904 2.223C4.978 12.711 6.427 13 8 13h.027a4.552 4.552 0 0 1 .23-2.002Zm-.002 3L8 14c-1.682 0-3.278-.307-4.51-.867-.486-.22-1.033-.54-1.49-.972V13c0 1.007.875 1.755 1.904 2.223C4.978 15.711 6.427 16 8 16c.536 0 1.058-.034 1.555-.097a4.507 4.507 0 0 1-1.3-1.905Z" />
                                                                            <path d="M16 12.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0Zm-3.5-2a.5.5 0 0 0-.5.5v1.5a.5.5 0 0 0 1 0V11a.5.5 0 0 0-.5-.5Zm0 4a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1Z" />
                                                                        </svg>
                                                                    </div>
                                                                    <div class="mt-2">
                                                                        <div class="fw-semibold text-gray-800 text-center fs-5">
                                                                            No data found
                                                                        </div>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr ng-if="ExamResult.QuestionMapResults.length > 0" id="collapseExample{{current1}}">
                                                                <td class="text-end">
                                                                    <table class="table align-middle fs-6 gy-3  no-footer mb-0">
                                                                        <thead style=" background: #f5f5f5; border-bottom: 1px solid #e1e1e1; border-top: 1px solid #e1e1e1;">
                                                                            <tr class="text-start align-middle text-gray-600 fw-normal fs-7  gs-0 text-truncate">
                                                                                <th class="text-md-center align-middle pe-3 min-w-30px sorting_disabled">Sl no.</th>
                                                                                <th class="text-start align-middle pe-3 min-w-150px sorting">Question</th>
                                                                                <th class="text-end align-middle pe-3 min-w-30px sorting">Qn total marks</th>
                                                                                <th class="text-end align-middle pe-3 min-w-0px sorting">Marks obtained</th>
                                                                                <th class="text-end align-middle pe-3 min-w-0px sorting">Remarks</th>
                                                                                <th class="text-end align-middle  min-w-30px sorting"></th>
                                                                                <th class="text-end align-middle  min-w-30px sorting"></th>
                                                                                <th class="text-end align-middle  min-w-30px pe-3 sorting"></th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody class="fw-normal text-gray-800 text-truncate">
                                                                            <tr ng-repeat-start="questionMap in ExamResult.QuestionMapResults track by $index" ng-init="current = $parent.start; $parent.start=$parent.start+1;">
                                                                                <td class="text-md-center align-middle">
                                                                                    {{$index + 1}}
                                                                                </td>
                                                                                <td class="text-start align-middle">
                                                                                    {{questionMap.Question}}
                                                                                </td>
                                                                                <td class="text-end align-middle">
                                                                                    {{questionMap.TotalMarksOfQuestion}}
                                                                                </td>
                                                                                <td class="text-end align-middle">
                                                                                    <span><input type="text" ng-model="questionMap.Marks" ng-change="GridMarkChanges(ExamResult, questionMap)" /></span>
                                                                                </td>
                                                                                <td class="text-end align-middle">
                                                                                    <span><input type="text" ng-model="questionMap.Remarks" /></span>
                                                                                </td>
                                                                                <td class="text-end">
                                                                                    <div class="controls text-center">
                                                                                        <button type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample{{current.toString()}}" aria-expanded="false" aria-controls="collapseExample{{current.toString()}}"
                                                                                                class="btn btn-sm btn-icon btn-light btn-active-light-primary toggle h-25px w-25px">
                                                                                            <span class="svg-icon svg-icon-3 m-0" ng-if="questionMap.IsExpand">
                                                                                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                                                    <rect x="6" y="11" width="12" height="2" rx="1" fill="currentColor"></rect>
                                                                                                </svg>
                                                                                            </span>
                                                                                            <span class="svg-icon svg-icon-3 m-0" ng-if="!questionMap.IsExpand">
                                                                                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                                                    <rect opacity="0.5" x="11" y="18" width="12" height="2" rx="1" transform="rotate(-90 11 18)" fill="currentColor"></rect>
                                                                                                    <rect x="6" y="11" width="12" height="2" rx="1" fill="currentColor"></rect>
                                                                                                </svg>

                                                                                            </span>
                                                                                            <!--end::Svg Icon-->
                                                                                        </button>

                                                                                        @*<button data-toggle="collapse" data-target="#collapseExample{{current}}" aria-expanded="false" aria-controls="collapseExample1{{current}}"
                                                                                                type="button" class="btn btn-sm btn-icon btn-light btn-active-light-primary toggle h-25px w-25px"
                                                                                                ng-click="ExpandCollapase($event, questionMap, 'IsExpand')">

                                                                                            <i ng-if="questionMap.IsExpand" class="fa  fa fa-angle-double-down"></i>
                                                                                            <i ng-if="!questionMap.IsExpand" class="fa  fa fa-angle-double-up"></i>
                                                                                        </button>*@
                                                                                    </div>
                                                                                </td>
                                                                            </tr>
                                                                            <tr class="collapse" id="collapseExample{{current.toString()}}" ng-if="questionMap.QuestionOptions.length == 0">
                                                                                <td class="text-start">
                                                                                </td>
                                                                                <td class="text-end">
                                                                                    <textarea id="textAnswer" name="textAnswer" rows="5" cols="100" disabled>{{questionMap.CandidateTextAnswer}}</textarea>
                                                                                </td>
                                                                            </tr>
                                                                            <tr class="collapse" id="collapseExample{{current.toString()}}"
                                                                                ng-repeat-start="option in questionMap.QuestionOptions track by $index" ng-if="questionMap.QuestionOptions.length > 0">

                                                                                <td class="text-end">
                                                                                </td>
                                                                                <td class="text-end">
                                                                                    <div class="text-gray-800 fs-7">Option</div>
                                                                                    <span ng-bind="option.OptionText" class="text-muted fs-7 fw-bold"></span><span class="redcolor"></span>
                                                                                </td>
                                                                                <td class="text-start" ng-if="option.IsSelected">
                                                                                    <label style="color:green">Selected</label>
                                                                                </td>
                                                                                <td class="text-end">
                                                                                </td>
                                                                            </tr>
                                                                            <tr ng-repeat-end="" class="ng-scope"></tr>
                                                                            <tr ng-repeat-end="" class="ng-scope"></tr>
                                                                        </tbody>
                                                                    </table>
                                                                </td>

                                                            </tr>
                                                        </tbody>
                                                        <!--end::Table body-->
                                                    </table>
                                                </div><div class="row"><div class="col-sm-12 col-md-5 d-flex align-items-center justify-content-center justify-content-md-start"></div><div class="col-sm-12 col-md-7 d-flex align-items-center justify-content-center justify-content-md-end"></div></div>
                                            </div>
                                            <!--end::Table-->
                                        </div>
                                        <!--end::Card body-->
                                    </div>
                                </div>
                                <!--end::Row-->
                            </div>
                        </div>
                        <!--end::Content container-->
                    </div>
                </div>

            </div>

        </div>
    </div>
</div>