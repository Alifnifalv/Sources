@model Eduegate.Web.Library.ViewModels.SearchListViewModel

@{ 
    if (Context.Request.Headers["X-Requested-With"] == "XMLHttpRequest")
    {
        Layout = null;
    }

    Random rnd = new Random();
    var windowName = "window_" + rnd.Next().ToString();
}

<div id="SalarySlipPublish" class="windowcontainer" ng-controller="SalarySlipPublishController" ng-init="Init(@Newtonsoft.Json.JsonConvert.SerializeObject(Model),'@windowName', 'salarySlipPublish')">
    <div class="window-tab preload-overlay" style="display:none;">
        <div class="preloader"><img src="/Images/preloader.GIF" width="32" height="32" alt="Loading" /></div>
    </div>
    <div class="main-page row">
        <div class="col-md-12">
            <div class="app-toolbar ">
                <div class="app-container  container-fluid d-flex align-items-stretch ">
                    <div class="app-toolbar-wrapper d-flex flex-stack flex-wrap gap-4 w-100">
                        <div class="page-title d-flex flex-column justify-content-center gap-1 me-3">
                            <h1 class="page-heading d-flex flex-column justify-content-center text-dark fw-bold fs-3 m-0">
                                Salary Slip Review & Publish
                            </h1>
                            <ul class="breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0">
                                <li class="breadcrumb-item text-muted">
                                    <a class="text-muted text-hover-primary">
                                        HR
                                    </a>
                                </li>
                                <li class="breadcrumb-item">
                                    <span class="bullet bg-gray-400 w-5px h-2px"></span>
                                </li>
                                <li class="breadcrumb-item text-muted">
                                    Salary slip
                                </li>

                            </ul>
                        </div>
                        <div class="d-flex align-items-center gap-2 gap-lg-3">
                            <a value="Publish" ng-click="PublishSalarySlips()" class="button-orange alignright">
                                Publish
                            </a>

                            <a value="Email" ng-click="SendSalarySlipMail()" class="button-orange alignright">
                                Email
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-12">
            <div class="app-content  flex-column-fluid ">
                <div class="app-container  container-fluid ">
                    <div class="productGrid_massaction">
                    <div class="row gy-5 g-xl-10">
                        <div class="col">
                            <span class="form-group">
                                <span class="controls w-100">
                                    <label>Month<span class="cufon" style="color:red;font-weight:700">&nbsp;*</span></label>
                                    <span class="controls brand">
                                        <select class="form-control validate" required="" aria-required="true" name="SelectedMonth" id="SelectedMonth"
                                                ng-options="item as item.Value for item in Months track by item.Key"
                                                ng-model="SelectedMonth" autofocus=autofocus tabindex="0">
                                        </select>
                                        <i class="dropdownarrow fa fa-caret-down"></i>
                                    </span>
                                </span>
                            </span>
                        </div>
                        <div class="col">
                            <span class="form-group">
                                <span class="controls w-100">
                                    <label>Year<span class="cufon" style="color:red;font-weight:700">&nbsp;*</span></label>
                                    <span class="controls brand">
                                        <select class="form-control validate" required="" aria-required="true" name="SelectedYear" id="SelectedYear"
                                                ng-options="item as item.Value for item in Years track by item.Key"
                                                ng-model="SelectedYear">
                                        </select>
                                        <i class="dropdownarrow fa fa-caret-down"></i>
                                    </span>
                                </span>
                            </span>
                        </div>
                            <div class="col">
                                <span class="form-group">
                                    <span class="controls w-100">
                                    <label>Employee</label>
                                    <span class="controls brand">
                                            <ui-select style="width: 100%;" ng-model="SelectedEmployee" ng-change="EmployeeChanges($select.selected)"
                                                   theme="select2" class="pos-txt" sortable="true" name="SelectedEmployee" id="SelectedEmployee">
                                            <ui-select-match placeholder="Search">{{$select.selected.Value}}</ui-select-match>
                                            <ui-select-choices repeat="data in Employees | filter:$select.search">{{data.Value}}</ui-select-choices>
                                        </ui-select>
                                    </span>
                                </span>
                            </span>
                        </div>
                        <div class="col">
                            <span class="form-group">
                                <span class="controls w-100">
                                    <label>Department</label>
                                    <span class="controls brand">
                                        <select class="form-control validate" name="SelectedDepartment" id="SelectedDepartment"
                                                ng-options="item as item.Value for item in Departments track by item.Key"
                                                ng-model="SelectedDepartment">
                                            <option value=""></option>
                                        </select>
                                        <i class="dropdownarrow fa fa-caret-down"></i>
                                    </span>
                                </span>
                            </span>

                            <span class="controls">

                            </span>
                        </div>
                        <div class="col">
                            <input type="button" value="Load" class="button-orange alignright" ng-click="GetEmployeesSalarySlip()" />
                        </div>
                    </div>
                    </div>
                    <div class="row gy-5 g-xl-10">
                        <div class="col-md-12">
                            <div class="app-content  flex-column-fluid">

                                <div class="card card-flush mb-5 mb-xl-10">
                                    <div class="card-body p-0">
                                        <div class="dataTables_wrapper dt-bootstrap4 no-footer">
                                            <div class="table-responsive">
                                                <table class="table align-middle fs-6 gy-3  no-footer mb-0">
                                                    <thead style=" background: #f5f5f5; border-bottom: 1px solid #e1e1e1; border-top: 1px solid #e1e1e1;">
                                                        <tr class="text-start align-middle text-gray-600 fw-normal fs-7  gs-0 text-truncate">
                                                            <th class="min-w-20px sorting ps-3 align-middle"><input type="checkbox" name="IsSelectedToPublish" id="IsSelectedToPublish" ng-click="SelectedHeaderCheckBox()" /></th>
                                                            <th class="text-start align-middle pe-3 min-w-30px sorting_disabled">SL. No.</th>
                                                            <th class="text-start align-middle pe-3 min-w-150px sorting">Employee name</th>
                                                            <th class="text-end align-middle pe-3 min-w-30px sorting">Working days</th>
                                                            <th class="text-end align-middle pe-3 min-w-0px sorting">Normal hours</th>
                                                            <th class="text-end align-middle  min-w-30px sorting">OT hours</th>
                                                            <th class="text-end align-middle  min-w-30px sorting">LOP days</th>
                                                            <th class="text-end align-middle  min-w-75px sorting">Earnings</th>
                                                            <th class="text-end align-middle  min-w-75px sorting">Deductions</th>
                                                            <th class="text-end align-middle  min-w-75px sorting">Paying</th>
                                                            <th class="text-end align-middle  min-w-75px sorting">
                                                                Verification status<br />
                                                                <div class="controls brand  min-w-100px">
                                                                    <select class="form-control validate" name="VerifiedStatus" id="VerifiedStatus"
                                                                            ng-change="ChangeVerifiedDropdownData()"
                                                                            ng-options="item as item.Value for item in VerifiedStatuses track by item.Key"
                                                                            ng-model="VerifiedStatus">
                                                                    </select>
                                                                    <i class="dropdownarrow fa fa-caret-down"></i>
                                                                </div>
                                                            </th>
                                                            <th class="text-end align-middle  min-w-75px sorting">Status</th>
                                                            <th class="text-end align-middle  min-w-30px sorting"></th>
                                                            <th class="text-end align-middle  min-w-30px sorting"></th>
                                                            <th class="text-end align-middle  min-w-30px pe-3 sorting"></th>

                                                        </tr>
                                                    </thead>
                                                    <tbody class="fw-normal text-gray-800 text-truncate">

                                                        <tr ng-if="SalarySlips.length == 0" colspan="100%">
                                                            <td >
                                                               <center>
                                                                    <span>No records found!!</span>
                                                                </center>
                                                            </td>
                                                        </tr>
                                                        <tr class="odd" ng-repeat="detail in SalarySlips">
                                                            <!--begin::Item-->
                                                            <td class="ps-3 align-middle">
                                                                <input type="checkbox" name="IsSelected" id="IsSelected" ng-model="detail.IsSelected" />
                                                            </td>
                                                            <td class="text-start align-middle">
                                                                {{$index +1}}
                                                            </td>
                                                            <td class="text-start align-middle" data-order="2023-04-20T00:00:00+05:30">
                                                                {{detail.EmployeeName}}
                                                            </td>
                                                            <td class="text-end align-middle">
                                                                {{detail.WorkingDays}}
                                                            </td>
                                                            <td class="text-end align-middle">
                                                                {{detail.NormalHrs}}
                                                            </td>

                                                            <td class="text-end align-middle">
                                                                {{detail.OTHrs}}
                                                            </td>
                                                            <td class="text-end align-middle">
                                                                {{detail.LOPDays}}
                                                            </td>
                                                            <td class="text-end align-middle">
                                                                {{detail.EarningAmount | number:DefaultDecimalPoint}}
                                                            </td>
                                                            <td class="text-end align-middle">
                                                                {{detail.DeductingAmount | number:DefaultDecimalPoint}}
                                                            </td>
                                                            <td class="text-end align-middle">
                                                                {{detail.AmountToPay | number:DefaultDecimalPoint}}
                                                            </td>
                                                            <td class="text-end align-middle align-middle">
                                                                <div class="form-check form-switch form-check-custom form-check-solid">
                                                                    <input class="form-check-input h-20px w-30px" type="checkbox" value="" id="flexSwitch20x30" ng-model="detail.IsVerified" ng-change="IsVerifiedStatusChanges(detail)" />
                                                                    <label class="form-check-label" for="flexSwitch20x30">
                                                                        <span class="label-text-unchecked">
                                                                            Not verified
                                                                        </span>
                                                                        <span class="label-text-checked " style=" display: none;">
                                                                            verified
                                                                        </span>
                                                                    </label>
                                                                    <style>
                                                                        #flexSwitch20x30:checked + label .label-text-unchecked {
                                                                            display: none !important;
                                                                        }

                                                                        #flexSwitch20x30:checked + label .label-text-checked {
                                                                            display: block !important;
                                                                        }
                                                                    </style>
                                                                </div>
                                                            </td>
                                                            <td class="text-end align-middle">
                                                                <span class="controls brand min-w-75px">
                                                                    <select class="form-control  validate" required="" aria-required="true" name="PublishStatusID" id="PublishStatusID"
                                                                            ng-options="item as item.Value for item in SalarySlipStatuses track by item.Key"
                                                                            ng-model="detail.PublishStatus">
                                                                    </select>
                                                                    <i class="dropdownarrow fa fa-caret-down"></i>
                                                                </span>
                                                            </td>
                                                            <td class="text-end align-middle" data-order="58">
                                                                <div class="symbol symbol-30px" ng-click="ApplyAndUpdateSlipData(detail)">
                                                                    <span class="symbol-label">

                                                                        <?xml version="1.0" ?>
                                                                        <svg class="bi bi-check fs-3 text-gray-600" id="Layer_1" style="enable-background:new 0 0 30 30;" version="1.1" viewBox="0 0 30 30" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M22,4h-2v6c0,0.552-0.448,1-1,1h-9c-0.552,0-1-0.448-1-1V4H6C4.895,4,4,4.895,4,6v18c0,1.105,0.895,2,2,2h18  c1.105,0,2-0.895,2-2V8L22,4z M22,24H8v-6c0-1.105,0.895-2,2-2h10c1.105,0,2,0.895,2,2V24z" /><rect height="5" width="2" x="16" y="4" /></svg>
                                                                    </span>
                                                                </div>
                                                            </td>
                                                            <!--end::Qty-->
                                                            <td class="text-end align-middle" data-order="58">

                                                                <div class="symbol symbol-30px" ng-click="ViewSalarySlip(detail)">
                                                                    <span class="symbol-label">
                                                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
                                                                            <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z" />
                                                                            <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z" />
                                                                        </svg>
                                                                    </span>
                                                                </div>
                                                            </td>
                                                            <td class="text-end align-middle pe-3" data-order="58">
                                                                <div class="symbol symbol-30px" ng-click="EditSalarySlip(detail.SalarySlipIID)">
                                                                    <span class="symbol-label">
                                                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                                                                            <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z" />
                                                                            <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z" />
                                                                        </svg>
                                                                    </span>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                    <!--end::Table body-->
                                                </table>
                                            </div><div class="row"><div class="col-sm-12 col-md-5 d-flex align-items-center justify-content-center justify-content-md-start"></div><div class="col-sm-12 col-md-7 d-flex align-items-center justify-content-center justify-content-md-end"></div></div>
                                        </div>
                                        <!--end::Table-->
                                    </div>
                                    <!--end::Card body-->
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--end::Row-->


                </div>
                <!--end::Content container-->
            </div>
            <div class="modal right" id="globalRightDrawer" tabindex="-1" aria-labelledby="rightModalLabel" aria-hidden="true">
                <div class="modal-dialog  modal-dialog-centered modal-lg w-100">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title"></h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>